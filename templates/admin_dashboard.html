<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard - Policy Pulse AI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="{{ url_for('static', filename='js/chart.js') }}"></script>
</head>

<body class="dashboard-body">

<div class="sidebar">
    <h2>Policy Pulse</h2>

    <a href="/dashboard">Dashboard</a>
    <a href="/upload-policy">Upload Policy</a>
    <a href="/scheme-advisor">Scheme Advisor</a>
    <a href="/admin" style="color:#38bdf8;">Admin Panel</a>
    <a href="/logout">Logout</a>
</div>

<div class="main-content">

    <div class="top-header">
        <h1>System Control Center</h1>
        <div class="policy-count">
            Administrative Overview
        </div>
    </div>

    <!-- METRICS -->
    <div class="metrics-grid">

        <div class="metric-card">
            <h3>Total Users</h3>
            <div class="metric-value">{{ total_users }}</div>
        </div>

        <div class="metric-card">
            <h3>Total Policies</h3>
            <div class="metric-value">{{ total_policies }}</div>
        </div>

        <div class="metric-card">
            <h3>Top Keyword</h3>
            <div class="metric-value">
                {% if top_keywords %}
                    {{ top_keywords[0][0] }}
                {% else %}
                    -
                {% endif %}
            </div>
        </div>

    </div>

    <!-- SENTIMENT CHART -->
    <div class="chart-container">
        <h3>Platform Sentiment Distribution</h3>
        <div class="chart-wrapper">
            <canvas id="adminSentimentChart"></canvas>
        </div>
    </div>

</div>

<script>
document.addEventListener("DOMContentLoaded", function() {

    const labels = {{ sentiment_counts.keys()|list|tojson|safe }};
    const values = {{ sentiment_counts.values()|list|tojson|safe }};

    const ctx = document.getElementById("adminSentimentChart");

    if(ctx){
        new Chart(ctx, {
            type: "bar",
            data: {
                labels: labels,
                datasets: [{
                    label: "Policies",
                    data: values,
                    backgroundColor: "#0ea5e9"
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    }
});
</script>

</body>
</html>